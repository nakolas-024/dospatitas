---
// src/pages/index.astro (Revisado y Correcto)
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import ProductCard from '../components/ProductCard.astro';
// Temporalmente usamos datos locales. Idealmente cambiar a Supabase.
import products from '../data/products.js';

function shuffle(array) {
  return array.map(value => ({ value, sort: Math.random() }))
             .sort((a, b) => a.sort - b.sort)
             .map(({ value }) => value);
}
// Asegurarse de que el formato de 'products' sea compatible con ProductCard
const featuredProducts = shuffle(products).slice(0, 6);
---

<Layout title="Dos Patitas - Carnets de Control Sano Personalizados">
  {/* Header/Footer/Modals son añadidos por Layout.astro */}

  <main>
    <Hero />

    {featuredProducts.length > 0 && (
      <section class="featured-products">
        <div class="container">
          <div class="section-header">
            <h2>Diseños Destacados</h2>
            <p class="subtitle">Una selección de nuestros carnets más queridos.</p>
          </div>

          <div class="product-grid">
            {featuredProducts.map(product => (
              // Pasamos el objeto 'product' completo
              <ProductCard product={product} />
            ))}
          </div>

          <div class="section-footer">
            <a href="/catalogo" class="btn-view-all">
              Ver todos los diseños &rarr;
            </a>
          </div>
        </div>
      </section>
    )}
  </main>

</Layout>

<style>
/* Estilos específicos para esta página */
.featured-products { padding: 6rem 1rem; background: #fef7fb; }
.container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; width: 100%; }
.section-header { text-align: center; margin-bottom: 3rem; }
.section-header h2 { font-size: 2.5rem; font-weight: 800; color: #2d3748; margin: 0 0 0.5rem; }
.section-header .subtitle { font-size: 1.1rem; color: #555; max-width: 600px; margin: 0 auto; }
.product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2.5rem; }
.section-footer { text-align: center; margin-top: 3rem; }
.btn-view-all { display: inline-block; background-color: #ffafcc; color: #333; padding: 1rem 2.5rem; border-radius: 50px; font-weight: 700; text-decoration: none; transition: all 0.3s ease; }
.btn-view-all:hover { background-color: #ff7bb0; color: #fff; transform: translateY(-2px) scale(1.03); }
@media (min-width:1536px) { .container { max-width: 1440px; } }
</style>