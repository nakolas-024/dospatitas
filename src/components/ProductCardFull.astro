---
const { product } = Astro.props;

// Imagen completa o alternativa
const imgFull = product.image_url_full || product.image_url_ref || '/images/placeholder.png';
---

<div class="product-card-full">
  <div class="img-wrapper">
    <img src={imgFull} alt={product.name} loading="lazy" />
  </div>
  <h3>{product.name}</h3>
  <button class="add-to-cart" onclick={`addToCart(${JSON.stringify(product).replace(/"/g, '&quot;')})`}>
    AÃ±adir al carrito ðŸ›’
  </button>
</div>

<script>
  // Sistema de carrito reutilizable
  function addToCart(product) {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const existing = cart.find(item => item.id === product.id);

    if (existing) {
      existing.quantity += 1;
    } else {
      cart.push({ ...product, quantity: 1 });
    }

    localStorage.setItem('cart', JSON.stringify(cart));

    // Feedback visual
    const buttons = document.querySelectorAll('.add-to-cart');
    buttons.forEach(btn => {
      if (btn.getAttribute('onclick').includes(product.id)) {
        btn.textContent = 'âœ… Agregado';
        btn.disabled = true;
        setTimeout(() => {
          btn.textContent = 'AÃ±adir al carrito ðŸ›’';
          btn.disabled = false;
        }, 1500);
      }
    });
  }
</script>

<style>
.product-card-full {
  background: #fff;
  border-radius: 16px;
  padding: 1.5rem;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
  text-align: center;
  transition: all 0.3s ease;
}

.product-card-full:hover {
  transform: translateY(-6px);
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
}

.img-wrapper {
  overflow: hidden;
  border-radius: 12px;
  margin-bottom: 1rem;
}

.product-card-full img {
  width: 100%;
  height: 320px;
  object-fit: cover;
  border-radius: 12px;
  transition: transform 0.4s ease;
}

.product-card-full:hover img {
  transform: scale(1.05);
}

.product-card-full h3 {
  font-size: 1.3rem;
  font-weight: 700;
  color: #333;
  margin-bottom: 1rem;
}

.add-to-cart {
  background: #f0ce0c;
  color: #333;
  font-weight: 700;
  padding: 0.8rem 1.8rem;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  transition: background 0.25s ease;
}

.add-to-cart:hover {
  background: #fc9700;
  color: #fff;
}
</style>
